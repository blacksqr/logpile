refactor to allow multiple indexes or searches
